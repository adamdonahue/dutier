{"version":3,"sources":["../src/dutier.js"],"names":["_state","_initialState","_handlers","_reducers","applyReducer","action","initialState","Object","assign","actualState","keys","forEach","value","reducer","call","JSON","stringify","type","state","applyHandler","handler","undefined","subscribe","push","unsubscribe","fn","index","splice","dispatch","payload","Promise","resolve","then","combine","len","length","reducers","createStore","getState","dutier","exports","module","define","amd","window","Dutier"],"mappings":"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","file":"dutier.js","sourcesContent":[";(function() {\n /**\n  * @name _state\n  * @description The actual store application state\n  */\n  const _state = {}\n  /**\n  * @name _initialState\n  * @description The initial store application state\n  */\n  const _initialState = {}\n  /**\n  * @name _handlers\n  * @description The subscribe handlers function\n  */\n  const _handlers = []\n  /**\n  * @name _reducers\n  * @description The action reducers\n  */\n  const _reducers = {}\n  \n  // apply the correspondent action reducer\n  function applyReducer( action ) {\n    const initialState = Object.assign({}, _initialState)\n    const actualState = Object.assign(initialState, _state)\n    Object.keys(_reducers)\n      .forEach( reducer => {\n        const value = _reducers[reducer].call(null, actualState, action)\n        if ( JSON.stringify(value) !== JSON.stringify(actualState) ) {\n          return Object.assign(_state, initialState, value)\n        }\n      })\n    return Object.assign({}, { type: action.type } , { state: Object.assign({}, _state) })\n  }\n  // apply all subscribe handlers\n  function applyHandler( { type } ) {\n    const state = Object.assign({}, _state)\n    _handlers.forEach( handler => {\n      if (handler !== undefined && typeof handler === 'function') {\n        handler({ type, state })\n      }\n    })\n    return { type, state }\n  }\n  /**\n   * @name subscribe\n   * @description Subscribe to call the handler function when the action will be triggered\n   * @param {Function} handler The function that will be called\n   **/\n  function subscribe( handler ){\n    _handlers.push(handler)\n    return () => {\n      unsubscribe(handler)\n    }\n  }\n  /**\n   * @name unsubscribe\n   * @description Unsubscribes from listening to a component\n   * @param {Function} handler The handler function\n   **/\n  function unsubscribe( handler ) {\n    _handlers.forEach( ( fn, index ) => {\n      if ( fn === handler) {\n        _handlers.splice(index, 1)\n      }\n    })\n  }\n  /**\n   * @name dispatch\n   * @description Dispatch an action to change\n   * the store state\n   * @param { Object } payload The action payload\n   */  \n  function dispatch ( payload ) {\n    return Promise.resolve(payload)\n        .then(applyReducer)\n        .then(applyHandler)\n  }\n  /**\n   * @name combine\n   * @description Combine the reducers\n   */  \n  function combine( ...reducers ) {\n    const len =  Object.keys(_reducers).length\n    reducers.forEach( reducer => _reducers[len + 1] = reducer)\n  }\n  /**\n  * @name createStore\n  * @description Sets the application data state\n  * @param {Object} data Simple Object that contain the State\n  */\n  function createStore ( initialState, ...reducers ) {\n    reducers.forEach( ( reducer, index ) => _reducers[index] = reducer )\n    Object.assign(_initialState, initialState)\n  }\n  /**\n   * @name getState\n   * @return {Object} a copy of the state\n   */  \n  function getState() {\n    return Object.assign({}, _initialState, _state)\n  }\n  \n  const dutier = {\n    createStore,\n    combine,\n    subscribe,\n    getState,\n    dispatch\n  }\n  if (typeof exports === 'object') {\n    module.exports = dutier;\n  }\n  else if (typeof define === 'function' && define.amd) {\n    define([], dutier)\n  }\n  else {\n    window.Dutier = dutier;\n  }\n}())"]}