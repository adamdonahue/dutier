{"version":3,"sources":["../src/dutier.js"],"names":["root","factory","define","amd","exports","module","dispatch","getState","createStore","subscribe","middleware","unsubscribe","Dutier","global","_store","state","components","applyMiddleware","action","call","Object","assign","mockStoreState","updateComponent","forEach","el","component","undefined","handler","push","index","splice","callback","Promise","resolve","then"],"mappings":";;AAAA,CAAE,WAAUA,IAAV,EAAgBC,OAAhB,EAAyB;AACzB,MAAI,OAAOC,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAA3C,EAAgD;AAC9CD,WAAO,EAAP,EAAWD,OAAX;AACD,GAFD,MAEO,IAAI,QAAOG,OAAP,yCAAOA,OAAP,OAAmB,QAAvB,EAAiC;AACtCC,WAAOD,OAAP,GAAiB;AACfE,gBAAUL,QAAQK,QADH;AAEfC,gBAAUN,QAAQM,QAFH;AAGfC,mBAAaP,QAAQO,WAHN;AAIfC,iBAAWR,QAAQQ,SAJJ;AAKfC,kBAAYT,QAAQS,UALL;AAMfC,mBAAaV,QAAQU;AANN,KAAjB;AAQD,GATM,MASA;AACLX,SAAKY,MAAL,GAAcX,OAAd;AACD;AACF,CAfC,EAeA,IAfA,EAeM,UAAUY,MAAV,EAAkB;AACxB;;;;AAIA,MAAID,SAAS;AACX;;;;AAIAE,YAAQ;AACN;;;;AAIAC,aAAO,EALD;AAMN;;;;AAIAC,kBAAY,EAVN;AAWNN,kBAAY;AAXN;AALG,GAAb;;AAoBA,WAASO,eAAT,CAA0BC,MAA1B,EAAkC;AAChC,WAAO,iBAAS;AACd,UAAIR,aAAaE,OAAOE,MAAP,CAAcJ,UAA/B;AACA;;;AAGA,UAAI,OAAOA,UAAP,KAAsB,UAA1B,EAAsC;AACpCA,mBAAWS,IAAX,CAAgB,IAAhB,EAAsBD,MAAtB,EAA8BE,OAAOC,MAAP,CAAc,EAAd,EAAkBT,OAAOU,cAAzB,CAA9B;AACD;;AAED,aAAOJ,MAAP;AACD,KAVD;AAWD;;AAED,WAASK,eAAT,CAA0BL,MAA1B,EAAkC;AAChCN,WAAOE,MAAP,CAAcE,UAAd,CAAyBQ,OAAzB,CAAiC,cAAM;AACrC,UAAIC,GAAGC,SAAH,KAAiBC,SAAjB,IAA8B,OAAOF,GAAGG,OAAV,KAAsB,UAAxD,EAAoE;AAClEH,WAAGG,OAAH,CAAWV,MAAX;AACD;AACF,KAJD;AAKA,WAAOA,MAAP;AACD;AACD,SAAO;AACL;;;;;;AAMAT,eAAW,mBAACiB,SAAD,EAAYE,OAAZ,EAAwB;AACjChB,aACGE,MADH,CAEGE,UAFH,CAGGa,IAHH,CAGQ,EAACH,oBAAD,EAAYE,gBAAZ,EAHR;AAID,KAZI;AAaLjB,iBAAa,qBAACe,SAAD,EAAe;AAC1B,UAAIV,aAAaJ,OAAOE,MAAP,CAAcE,UAA/B;AACAA,iBAAWQ,OAAX,CAAmB,UAACC,EAAD,EAAKK,KAAL,EAAe;AAChC,YAAIL,OAAOC,SAAX,EAAsB;AACpBV,qBAAWe,MAAX,CAAkBD,KAAlB,EAAyB,CAAzB;AACD;AACF,OAJD;AAKD,KApBI;AAqBL;;;;;;AAMApB,gBAAY,8BAAY;AACtBE,aAAOE,MAAP,CAAcJ,UAAd,GAA2BsB,QAA3B;AACD,KA7BI;AA8BL;;;;;;;AAOA1B,cAAU,kBAACY,MAAD,EAAY;AACpB,aAAOe,QACJC,OADI,CACIhB,MADJ,EAEJiB,IAFI,CAEClB,gBAAgBC,MAAhB,CAFD,EAGJiB,IAHI,CAGCZ,eAHD,CAAP;AAID,KA1CI;AA2CL;;;;;AAKAf,iBAAa,qBAACO,KAAD,EAAW;AACtB;AACAK,aAAOC,MAAP,CAAcT,OAAOE,MAAP,CAAcC,KAA5B,EAAmCA,KAAnC;AACD,KAnDI;AAoDL;;;;AAIAR,cAAU,oBAAM;AACd,aAAOa,OAAOC,MAAP,CAAc,EAAd,EAAkBT,OAAOE,MAAP,CAAcC,KAAhC,CAAP;AACD;AA1DI,GAAP;AA4DD,CA3GO,CA2GN,IA3GM,CAfN,CAAD","file":"dutier.js","sourcesContent":[";(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory)\n  } else if (typeof exports === 'object') {\n    module.exports = {\n      dispatch: factory.dispatch,\n      getState: factory.getState,\n      createStore: factory.createStore,\n      subscribe: factory.subscribe,\n      middleware: factory.middleware,\n      unsubscribe: factory.unsubscribe\n    }\n  } else {\n    root.Dutier = factory\n  }\n}(this, function (global) {\n  /**\n   * @name Dutier\n   * @description The object that will manage all application state\n   */\n  let Dutier = {\n    /**\n     * @name _store\n     * @description The private store\n     */\n    _store: {\n      /**\n       * @name state\n       * @description The Store application state\n       */\n      state: {},\n      /**\n       * @name state\n       * @description The Components that was subscribed\n       */\n      components: [],\n      middleware: {}\n    }\n  }\n\n  function applyMiddleware (action) {\n    return value => {\n      let middleware = Dutier._store.middleware\n      /**\n         * has middleware?\n         **/\n      if (typeof middleware === 'function') {\n        middleware.call(null, action, Object.assign({}, Dutier.mockStoreState))\n      }\n\n      return action\n    }\n  }\n\n  function updateComponent (action) {\n    Dutier._store.components.forEach(el => {\n      if (el.component !== undefined && typeof el.handler === 'function') {\n        el.handler(action)\n      }\n    })\n    return action\n  }\n  return {\n    /**\n     * @name subscribe\n     * @description Subscribe to call the handler function when the action will be triggered\n     * @param {Component} component The Component\n     * @param {Function} handler The function that will be called\n     **/\n    subscribe: (component, handler) => {\n      Dutier\n        ._store\n        .components\n        .push({component, handler})\n    },\n    unsubscribe: (component) => {\n      let components = Dutier._store.components\n      components.forEach((el, index) => {\n        if (el === component) {\n          components.splice(index, 1)\n        }\n      })\n    },\n    /**\n     * @name middleware\n     * @description The middleware function that will be triggered\n     * every time when an action called.\n     * @param {Function} callback A function that will be called\n     **/\n    middleware: callback => {\n      Dutier._store.middleware = callback\n    },\n    /**\n     * @name dispatch\n     * @description Dispatch an action to change\n     * the store state\n     * @param { string } action The action name\n     * @param { any } args Arguments sended to the action\n     */\n    dispatch: (action) => {\n      return Promise\n        .resolve(action)\n        .then(applyMiddleware(action))\n        .then(updateComponent)\n    },\n    /**\n     * @name setState\n     * @description Sets the application data state\n     * @param {object} data Simple Object that contain the State\n     */\n    createStore: (state) => {\n      // setting the immutable initial state return Dutier.store\n      Object.assign(Dutier._store.state, state)\n    },\n    /**\n     * @name getState\n     * @return {Object} a copy of the state\n     */\n    getState: () => {\n      return Object.assign({}, Dutier._store.state)\n    }\n  }\n}(this)))"]}